{% extends "base.html" %}
{% block content %}

<a href="{{ url_for('home') }}" class="inline-flex items-center text-sm font-semibold text-gray-600">
  ← Back
</a>

<div class="mt-4 bg-white rounded-2xl border shadow-sm p-4">
  <div class="flex items-start justify-between gap-3">
  <div>
    <div class="text-xl font-bold">{{ cat.name }}</div>

    {% if tx_type == 'withdraw' %}
      <div class="text-sm text-gray-600 mt-1">
        Available:
        <span class="font-semibold">
          {{ balances["USD"]|round(2) }} USD · {{ balances["EUR"]|round(2) }} EUR · {{ balances["TRY"]|round(2) }} TRY · {{ balances["LBP"]|round(2) }} LBP
        </span>
      </div>
    {% else %}
      <div class="text-sm text-gray-600 mt-1">Current balances available on home screen.</div>
    {% endif %}
  </div>


    <form method="post" action="{{ url_for('delete_category', category_id=cat.id) }}"
          onsubmit="return confirm('Delete this category and all its transactions?');">
      <button type="submit"
              class="rounded-xl border border-red-200 bg-red-50 px-3 py-2 text-sm font-semibold text-red-700">
        Delete
      </button>
    </form>

</div>


  <h2 class="mt-4 text-lg font-semibold">
    {% if tx_type == 'deposit' %}Add Amount{% else %}Withdraw{% endif %}
  </h2>

  <form class="mt-4 space-y-4" method="post" action="{{ url_for('save_tx', category_id=cat.id) }}">
    <input type="hidden" name="tx_type" value="{{ tx_type }}"/>

    <div>
      <label class="text-sm font-medium">Amount</label>
      <div class="mt-1 flex rounded-xl border overflow-hidden">
        <input name="amount" inputmode="decimal" placeholder="e.g. 10.50"
               class="w-full px-3 py-2 outline-none" required />
      </div>
    </div>

    <div>
      <label class="text-sm font-medium">Currency</label>
     <select id="currencySelect" name="currency"
        class="mt-1 w-full rounded-xl border px-3 py-2 bg-white" required>
        {% for c in currencies %}
          <option value="{{ c }}">{{ c }}</option>
        {% endfor %}
      </select>
        </div>
    
    <div>
      <label class="text-sm font-medium">Date</label>
      <input type="date" name="tx_date" value="{{ today }}"
             class="mt-1 w-full rounded-xl border px-3 py-2 bg-white" />
    </div>

    <div>
      <label class="text-sm font-medium">Note (optional)</label>
      <input type="text" name="note" placeholder="Optional note"
             class="mt-1 w-full rounded-xl border px-3 py-2 bg-white" />
    </div>

    <div class="grid grid-cols-2 gap-3 pt-2">
      <a href="{{ url_for('home') }}" class="rounded-2xl border bg-white py-3 font-semibold text-center">
        Cancel
      </a>
      <button class="rounded-2xl bg-blue-600 text-white py-3 font-semibold">
        Save
      </button>
    </div>
  </form>
</div>

{% endblock %}