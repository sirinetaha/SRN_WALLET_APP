{% extends "base.html" %}
{% block content %}

<section class="bg-white rounded-2xl p-4 shadow-sm border">
  <h2 class="text-lg font-semibold">Current Balance</h2>
  <div class="mt-3 grid grid-cols-2 gap-3">
  {% set ns = namespace(has_balance=false) %}

  {% for cur, val in global_balances.items() %}
    {% if val > 0 %}
      {% set ns.has_balance = true %}
      <div class="rounded-xl border bg-gray-50 px-3 py-3">
        <div class="text-xs text-gray-500">{{ cur }}</div>
        <div class="text-xl font-semibold">{{ "%.2f"|format(val) }}</div>
      </div>
    {% endif %}
  {% endfor %}

  {% if not ns.has_balance %}
    <div class="col-span-2 text-sm text-gray-500 text-center">
      No balance yet
    </div>
  {% endif %}
</div>


</section>

<div class="mt-4 grid grid-cols-2 gap-3">
  <a href="{{ url_for('add_category') }}" class="rounded-2xl bg-blue-50 border border-blue-200 px-4 py-3 font-semibold text-blue-800 text-center">
    + Add Category
  </a>
  <a href="{{ url_for('transactions') }}" class="rounded-2xl bg-white border px-4 py-3 font-semibold text-center">
    View Transactions
  </a>
  <a href="{{ url_for('reports') }}" class="col-span-2 rounded-2xl bg-white border px-4 py-3 font-semibold text-center">
    Show Reports
  </a>
</div>

<h3 class="mt-6 text-sm font-semibold text-gray-600">Categories</h3>

<div class="mt-3 space-y-3">
  {% for c in cat_cards %}
    <div class="bg-white rounded-2xl border shadow-sm p-4">
      <div class="flex items-center justify-between">
        <div class="font-semibold">{{ c.name }}</div>
        <div class="text-sm text-gray-600">
          <div class="text-sm font-semibold">
          {{ c.primary_currency }} {{ "%.2f"|format(c.primary_value) }}
        </div>

        <div class="mt-1 flex flex-wrap gap-2 text-xs text-gray-600">
          {% for cur, val in c.balances.items() %}
            {% if cur != c.primary_currency and val > 0 %}
              <span class="rounded-full bg-gray-100 px-2 py-1">
                {{ cur }} {{ "%.2f"|format(val) }}
              </span>
            {% endif %}
          {% endfor %}
        </div>

        </div>
      </div>

      <div class="mt-3 grid grid-cols-2 gap-3">
        <a href="{{ url_for('deposit_form', category_id=c.id) }}"
           class="rounded-xl bg-blue-100 text-blue-900 font-semibold py-2 text-center">
          Add amount
        </a>
        <a href="{{ url_for('withdraw_form', category_id=c.id) }}"
           class="rounded-xl bg-gray-100 text-gray-900 font-semibold py-2 text-center">
          Withdraw
        </a>
      </div>
    </div>
  {% endfor %}
</div>

{% endblock %}
